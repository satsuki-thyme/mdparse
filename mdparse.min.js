function mdparse(e,t){function n(){let e=[],t=0;return new Promise(n=>{function r(){if(e[t]={},e[t].indentVal=(u[t].match(/^[ \t]*/)||[])[0].length,!g&&k.test(u[t])&&(e[t].class="blank",t<h?(t++,r()):n(e)),!g&&N.test(u[t])&&(e[t].class="h",t<h?(t++,r()):n(e)),g||k.test(u[t])||N.test(u[t])||x.test(u[t])||E.test(u[t])||_.test(u[t])||R.test(u[t])||v.test(u[t])||G.test(u[t])||I.test(u[t])||(e[t].class="p",t<h?(t++,r()):n(e)),g||m||!w.test(u[t])||(e[t].class="li",L.test(u[t])&&(e[t].parent="ul"),q.test(u[t])&&(e[t].parent="ol"),y.test(u[t])&&(e[t].task=!0),m=!0,t<h?(t++,r()):n(e)),!g&&m&&L.test(u[t])&&(e[t].class="li",e[t].parent="ul",x.test(u[t+1])||(m=!1),y.test(u[t])&&(e[t].task=!0),t<h?(t++,r()):n(e)),!g&&m&&q.test(u[t])&&(e[t].class="li",e[t].parent="ol",x.test(u[t+1])||(m=!1),t<h?(t++,r()):n(e)),!g&&E.test(u[t])&&(e[t].class="bq",e[t].stack=u[t].match(/^>+/)[0].length,t<h?(t++,r()):n(e)),_.test(u[t])&&(e[t].class="preEnc",g?(e[t].site="end",g=!1,e[t].preGrp=e[t-1].preGrp):(e[t].site="begin",g=!0,e[t].preGrp=t,e[t].lang=u[t].replace(/(```|~~~)[ \t]*/,"")),t<h?(t++,r()):n(e)),g&&!_.test(u[t])&&(e[t].class="preEnc",e[t].site="middle",e[t].preGrp=e[t-1].preGrp,t<h?(t++,r()):n(e)),g||m||!R.test(u[t])||(e[t].class="preInd","preInd"===e[t-1].class&&R.test(u[t+1])&&(e[t].site="middle"),"preInd"!==e[t-1].class&&R.test(u[t+1])&&(e[t].site="begin"),"preInd"!==e[t-1].class||R.test(u[t+1])||(e[t].site="end"),"preInd"===e[t-1].class||R.test(u[t+1])||(e[t].site="az"),t<h?(t++,r()):n(e)),!g&&v.test(u[t])){function a(){"current"===e[t-1].hLine||"after"===e[t-1].hLine?e[t].hLine="after":e[t].hLine="unrelated"}if(e[t].class="table","table"===e[t-1].class&&v.test(u[t+1])&&(e[t].site="middle",e[t].tGrp=e[t-1].tGrp,a()),"table"!==e[t-1].class&&v.test(u[t+1])&&(e[t].site="begin",e[t].tGrp=t,a()),"table"!==e[t-1].class||v.test(u[t+1])||(e[t].site="end",e[t].tGrp=e[t-1].tGrp,a()),"table"===e[t-1].class||v.test(u[t+1])||(e[t].site="az",e[t].tGrp=t,a()),"current"===e[t-1].hLine&&e[t-1].beginWithHLine&&(e[t].beginWithHLine=!0),/^\|([ :]?-+[ :]?\|)+/.test(u[t])){function c(n,r){r--,e[r].tGrp===n&&(e[r].hLine="before",c(n,r)),e[r].tGrp!==n&&r===t-1&&(e[t].beginWithHLine=!0)}e[t].hLine="current",c(e[t].tGrp,t)}t<h?(t++,r()):n(e)}!g&&G.test(u[t])&&(e[t].class="footnote",t<h?(t++,r()):n(e)),!g&&I.test(u[t])&&(e[t].class="hr",t<h?(t++,r()):n(e))}r()})}function r(e){let t=[],n=[];for(let r in e)"preEnc"!==e[r].class&&"preInd"!==e[r].class&&(t.push((u[r].match(/^ +/)||[""])[0].length),n.push((u[r].match(/^\t+/)||[""])[0].length));t=Array.from(new Set(t)).sort((e,t)=>e-t),n=Array.from(new Set(n)).sort((e,t)=>e-t);let r=t.reduce((e,t)=>(e[0].push(t-e[1]),e[1]=t,e),[[],0]).shift(),a=n.reduce((e,t)=>(e[0].push(t-e[1]),e[1]=t,e),[[],0]).shift(),c=(e,t,n)=>(e[t]?e[t].add(n):e[t]=new Set(n),t),i=Math.min([...r.reduce(function(e,t){return t=String(t),this.set(t,c(e,this.get(t)+1||1,t)),e}.bind(new Map),[]).pop()].map(e=>Number(e))),s=Math.min([...a.reduce(function(e,t){return t=String(t),this.set(t,c(e,this.get(t)+1||1,t)),e}.bind(new Map),[]).pop()].map(e=>Number(e)));for(let t in e){let n=(u[t].match(/^[ \t]*/)||[""])[0];e[t].indentNum=Math.ceil(0!==i?(n.match(/ /g)||[]).length/i:0)+Math.ceil(0!==s?(n.match(/\t/g)||[]).length/s:0)}return e}function a(e){let t=/^\/?(html|head|title|base|link|style|meta|body|article|section|nav|aside|h1|h2|h3|h4|h5|h6|header|footer|address|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|figure|figcaption|main|div|a|em|strong|small|s|cite|q|dfn|abbr|code|var|samp|kbd|data|sub|sup|time|i|b|u|mark|ruby|rb|rt|rtc|rp|bdi|bdo|span|br|wbr|ins|del|img|picture|iframe|embed|object|param|video|audio|track|source|map|area|table|caption|colgroup|col|tbody|thead|tfoot|tr|td|th|form|fieldset|legend|label|input|select|option|optgroup|textarea|button|datalist|output|progress|meter|script|noscript|template|canvas|details|summary|menu|menuitem)$/;for(let n in e)"preEnc"===e[n].class||"preInd"===e[n].class?u[n]=u[n].replace(/<.+?>/g,e=>t.test(e.match(/(?<=<).+?(?=>)/)[0])?e:e.replace(/<(\/?.*)>/g,"&lt;$1&gt;")):u[n]=u[n].replace(/(?<!\\(?:\\\\)*)\\<(.*?)>/g,"&lt;$1&gt;").replace(/(?<!\\(?:\\\\)*)\\</g,"&lt;").replace(/(?<!\\(?:\\\\)*)\\>/g,"&gt;").replace(/(?<!\\(?:\\\\)*)\\(.)/g,"$1").replace(/\\\\/g,"\\");return e}function c(e){let n=0,r=[],a=[];return g&&(u=u.concat(["```"]),e=e.concat([{class:"preEnc",site:"end"}])),[new Promise(c=>{function i(){switch(e[n].class){case"blank":n<h?(n++,i()):c(e);break;case"h":u[n]=l(u,n),n<h?(n++,i()):c(e);break;case"p":n===h||"p"!==e[n+1].class||"permissive"===t?(u[n]=`<p>${u[n]}</p>`,n<h?(n++,i()):c(e)):(u[n+1]=`${u[n]}${p(u[n])}${u[n+1]}`,u=u.slice(0,n).concat(u.slice(n+1)),e=e.slice(0,n).concat(e.slice(n+1)),h--,n<h?i():c(e));break;case"li":u[n]=o(e,n),n<h?(n++,i()):c(e);break;case"bq":u[n]=d(e,n),n<h?(n++,i()):c(e);break;case"preEnc":"middle"===e[n].site&&"end"!==e[n+1].site&&(u[n]=`\n${u[n]}`,n<h?(n++,i()):c(e)),"begin"===e[n].site&&"end"!==e[n+1].site&&(u=u.slice(0,n).concat(u.slice(n+1)),e=e.slice(0,n).concat(e.slice(n+1)),h--,u[n]=""!==e[n].lang?`\n<pre><code class="language-${e[n].lang}">${u[n]}`:`\n<pre><code>${u[n]}`,n<h?i():c(e)),"begin"!==e[n].site&&"end"===e[n+1].site&&(u=u.slice(0,n+1).concat(u.slice(n+2)),e=e.slice(0,n+1).concat(e.slice(n+2)),h--,u[n]=`\n${u[n]}</code></pre>`,n<h?i():c(e)),"begin"===e[n].site&&"end"===e[n+1].site&&(u=u.slice(0,n).concat(u.slice(n+2)),e=e.slice(0,n).concat(e.slice(n+2)),h--,h--,u[n]=""!==e[n].lang?`\n<pre><code class="language-${e[n].lang}"><br></code></pre>`:"\n<pre><code><br></code></pre>",n<h?i():c(e));break;case"preInd":"middle"===e[n].site&&(u[n]=`${u[n].replace(b,"")}`),"begin"===e[n].site&&(u[n]=`<pre><code>${u[n].replace(b,"")}`),"end"===e[n].site&&(u[n]=`${u[n].replace(b,"")}</code></pre>`),"az"===e[n].site&&(u[n]=`<pre><code>${u[n].replace(b,"")}</code></pre>`),n<h?(n++,i()):c(e);break;case"table":if("current"!==e[n].hLine){let t="",r="",a="",s="";"middle"===e[n].site&&"current"!==e[n].hLine&&("before"===e[n].hLine&&(a="\n<th>",s="</th>"),"after"!==e[n].hLine&&"unrelated"!==e[n].hLine||(a="\n<td>",s="</td>"),e[n].beginWithHLine&&(t="\n<table>\n<tbody>",a="\n<td>",s="</td>"),"before"===e[n].hLine&&"current"===e[n+1].hLine&&"end"===e[n+1].site&&(r="\n</tbody>\n</table>",a="\n<th>",s="</th>")),"begin"===e[n].site&&("before"===e[n].hLine&&"current"!==e[n+1].hLine&&(t="\n<table>\n<thead>",a="\n<th>",s="</th>"),"before"===e[n].hLine&&"current"===e[n+1].hLine&&(t="\n<table>\n<thead>",r="\n</thead>",a="\n<th>",s="</th>"),"unrelated"===e[n].hLine&&(t="\n<table>\n<tbody>",a="\n<td>",s="</td>"),"before"===e[n].hLine&&"current"===e[n+1].hLine&&"end"===e[n+1].site&&(t="\n<table>\n<thead>",r="\n</thead>\n</table>",a="\n<td>",s="</td>")),"end"===e[n].site&&("after"===e[n].hLine&&"after"===e[n-1].hLine&&(r="\n</tbody>\n</table>",a="\n<td>",s="</td>"),"after"===e[n].hLine&&"before"===e[n-1].hLine&&(t="\n<tbody>",r="\n</tbody>\n</table>",a="\n<td>",s="</td>"),e[n].beginWithHLine&&(t="\n<table>\n<tbody>",r="\n</tbody>\n</table>",a="\n<td>",s="</td>"),"unrelated"===e[n].hLine&&(r="\n</tbody>\n</table>",a="\n<td>",s="</td>")),"az"===e[n].site&&(t="\n<table>\n<tbody>",r="\n</tbody>\n</table>",a="\n<td>",s="</td>"),u[n]=u[n].replace(/^\|/,"").replace(/[ \t]*(.*?)[ \t]*(?<!\\(\\\\)*)(?<!\\)\|/g,`${a}$1${s}`).replace(/^/,`${t}\n<tr>`).replace(/$/,`\n</tr>${r}`),n<h?(n++,i()):c(e)}else u=u.slice(0,n).concat(u.slice(n+1)),e=e.slice(0,n).concat(e.slice(n+1)),h--,n<h?i():c(e);break;case"footnote":r=r.concat([(u[n].match(/(?<=\[\^).+(?=\]:)/)||[])[0]]),a=a.concat([u[n].replace(/^\[\^.+?\]: ?/,"")]),u=u.slice(0,n).concat(u.slice(n+1)),e=e.slice(0,n).concat(e.slice(n+1)),h--,n<h?i():c(e);break;case"hr":u[n]="<hr>",n<h?(n++,i()):c(e);break;case"unmatched":n<h?(n++,i()):c(e);break;default:console.log(`unexpected error occured at line ${n}\n${u[n]}`),n<h?(n++,i()):c(e)}}i()}),r,a]}function i(e){u=u.filter(e=>0!==e.length);let t=[],n=0,r={},a=1,c={},i=/(?<!\\(?:\\\\)*|!)(?<=\[\^).+?(?=\](?!:))/g;for(let e in u)if(u[e]=u[e].replace(/(?!\\(?:\\\\)*|_)_(?!_)(.+?)(?<!_|\\(?:\\\\)*)_(?!_)/g,"<em>$1</em>").replace(/(?!\\(?:\\\\)*|_)__(?!_)(.+?)(?<!_|\\(?:\\\\)*)__(?!_)/g,"<strong>$1</strong>").replace(/(?!\\(?:\\\\)*)___(.+?)(?<!\\(?:\\\\)*)___/g,"<strong><em>$1</em></strong>").replace(/(?!\\(?:\\\\)*|\*)\*(?!\*)(.+?)(?<!\*|\\(?:\\\\)*)\*(?!\*)/g,"<em>$1</em>").replace(/(?!\\(?:\\\\)*|\*)\*\*(?!\*)(.+?)(?<!\*|\\(?:\\\\)*)\*\*(?!\*)/g,"<strong>$1</strong>").replace(/(?!\\(?:\\\\)*)\*\*\*(.+?)(?<!\\(?:\\\\)*)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/(?!\\(?:\\\\)*|~)~~(?!~)(.+?)(?<!\\(?:\\\\)*)~~(?!~)/g,"<del>$1</del>").replace(/(?!\\(?:\\\\)*|!)\[(.+?)(?<!\\(?:\\\\)*)\]\((.+?)\)/g,'<a href="$2">$1</a>').replace(/(?!\\(?:\\\\)*)!\[(.+?)(?<!\\(?:\\\\)*)\]\((.+?)\)/g,'<img src="$2" alt="$1">'),i.test(u[e])){let s=u[e].match(i);for(let i in s){t=t.concat([s[i]]),c[s[i]]?c[s[i]]=c[s[i]].concat([n]):c[s[i]]=[n],Object.keys(r).indexOf(t[n])<0&&(r[t[n]]=a,a++);let l=new RegExp(`(?<!\\\\(?:\\\\\\\\)*|!)\\[\\^${t[n]}\\](?!:)`);u[e]=u[e].replace(l,`<sup>[<a href="#user-content-${t[n]}" name="user-content-return-${n}">${r[t[n]]}</a>]</sup>`),n++}}return[t,c,r,e[1],e[2]]}function s(e){let t=Array.from(new Set(e[0])),n=e[1],r=e[2],a=e[3],c=e[4],i="\n<sectioin>\n<ul>",s=a.slice(),l=[],p=c.slice(),o=[];for(let e in t)for(let n in a)t[e]===a[n]&&(l=l.concat([a[n]]),s.splice(s.indexOf(a[n]),1),o=o.concat([c[n]]),p.splice(p.indexOf(c[n]),1));for(let e in l)for(let a in t){let c="";if(l[e]===t[a]){for(let e in n[t[a]])c+=`<a href="#user-content-return-${n[t[a]][e]}">${f}</a> `;i+=`\n<li><a name="user-content-${t[a]}">${r[t[a]]}</a>. ${o[e]} ${c}</li>`}}for(let e in s)i+=`\n<li>${p[e]}</li>`;return i+="\n<ul>\n</section>",u.join("\n")+i}function l(e,t){let n=e[t].match(/^#+/)[0].match(/#/g).length;return`<h${n}>${e[t].replace(/^#+ /,"")}</h${n}>`}function p(e){return!1===/<br>$/.test(e)?" ":""}function o(e,t){function n(e,t){let n=0;if(t<h){("li"!==e[t+1].class||e[t].parent!==e[t+1].parent&&0===e[t].indentNum&&0===e[t+1].indentNum)&&(n=1);let r=e[t].indentNum-e[t+1].indentNum+n,a=$.slice(-r);return $.splice(-1,r),(a instanceof Array||"array"==typeof a)&&(a=a.reverse().join("></")),`</${a}>`}{n=1;let r=$.pop(e[t].indentNum+ +n);return(r instanceof Array||"array"==typeof r)&&(r=r.reverse().join("></")),`</${r}>`}}function r(e,t){let n=new RegExp("^[ \\t]*[*+\\-] \\[ ?\\]"),r=new RegExp("^[ \\t]*[*+\\-] \\[[xX]\\]");return e[t].task?n.test(u[t])?'<li><input type="checkbox">':r.test(u[t])?'<li><input type="checkbox" checked>':void 0:"<li>"}if(t>0&&t<h){if((e[t].parent===e[t-1].parent||e[t].indentNum<e[t-1].indentNum)&&e[t].indentNum<=e[t-1].indentNum&&(e[t].parent===e[t+1].parent||e[t].indentNum<e[t+1].indentNum)&&e[t].indentNum<=e[t+1].indentNum)return`${r(e,t)}${u[t].replace(x,"")}</li>`;if((e[t].parent!==e[t-1].parent&&e[t].indentNum===e[t-1].indentNum||e[t].indentNum>e[t-1].indentNum)&&(e[t].parent===e[t+1].parent||e[t].indentNum<e[t+1].indentNum)&&e[t].indentNum<=e[t+1].indentNum)return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>`;if((e[t].parent===e[t-1].parent||e[t].indentNum<e[t-1].indentNum)&&e[t].indentNum<=e[t-1].indentNum&&(e[t].parent!==e[t+1].parent&&e[t].indentNum===e[t+1].indentNum||e[t].indentNum>e[t+1].indentNum))return`${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`;if((e[t].parent!==e[t-1].parent&&e[t].indentNum===e[t-1].indentNum||e[t].indentNum>e[t-1].indentNum)&&(e[t].parent!==e[t+1].parent&&e[t].indentNum===e[t+1].indentNum||e[t].indentNum>e[t+1].indentNum))return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`}if(0===t&&t<h){if(e[t].parent===e[t+1].parent&&e[t].indentNum<=e[t+1].indentNum)return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>`;if(e[t].parent!==e[t+1].parent||e[t].indentNum>e[t+1].indentNum)return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`}if(t>0&&t===h){if(e[t].parent===e[t-1].parent&&e[t].indentNum<=e[t-1].indentNum)return`${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`;if(e[t].parent!==e[t-1].parent||e[t].indentNum>e[t-1].indentNum)return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`}if(0===h)return $=$.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${u[t].replace(x,"")}</li>${n(e,t)}`}function d(e,t){if(e[t].stack<=e[t-1].stack&&e[t].stack<=e[t+1].stack)return u[t].replace(/^>+ ?/,"");if(("bq"!==e[t-1].class||e[t].stack>e[t-1].stack)&&"bq"===e[t+1].class){let n="";return n="bq"!==e[t-1].class?`${"<blockquote>".repeat(e[t].stack)}<p>`:`${"<blockquote>".repeat(e[t].stack-e[t-1].stack)}<p>`,`${n}${u[t].replace(/^>+ ?/,"")}`}if(("bq"!==e[t+1].class||e[t].stack>e[t+1].stack)&&"bq"===e[t-1].class){let n="";return n="bq"!==e[t+1].class?`${"</blockquote>".repeat(e[t].stack)}</p>`:`${"</blockquote>".repeat(e[t].stack-e[t+1].stack)}</p>`,`${u[t].replace(/^>+ ?/,"")}${n}`}if(("bq"!==e[t-1].class||e[t].stack>e[t-1].stack)&&("bq"!==e[t+1].class||e[t].stack>e[t+1].stack)){let n="",r="";return n="bq"!==e[t-1].class?`${"<blockquote>".repeat(e[t].stack)}<p>`:`${"<blockquote>".repeat(e[t].stack-e[t-1].stack)}<p>`,r="bq"!==e[t+1].class?`${"</blockquote>".repeat(e[t].stack)}</p>`:`${"</blockquote>".repeat(e[t].stack-e[t+1].stack)}</p>`,`${n}${u[t].replace(/^>+ ?/,"")}${r}`}}let u=e.replace(/  (\r?\n|$)/g,"<br>").split(/\r?\n/),h=u.length-1,b=null,m=!1,$=[],g=!1,f='<svg class="user-cnt-arrow" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0, 0, 16, 21"><path d="M 0,0 V 2 h 8 c 3,0 6,3 6,6 0,3 -3,6 -6,6 H 7 v 2 h 1 c 4,0 8,-4 8,-8 0,-4 -4,-8 -8,-8 z"/><path d="M 6,21 7,19 3,15 7,11 6,9 0,15 Z"/></svg>',k=new RegExp("^[ \\t]*$"),N=new RegExp("^#{1,6} "),w=new RegExp("^([*+\\-] |\\d+\\. )(?!.*([*\\-_][ \\t]*){2,}).*$"),x=new RegExp("^[ \\t]*([*+\\-] |\\d+\\. )(\\[[ xX]\\])?"),L=new RegExp("^[ \\t]*[*+\\-] "),y=new RegExp("^[ \\t]*[*+\\-] \\[[ xX]\\]"),q=new RegExp("^[ \\t]*\\d+\\. "),E=new RegExp("^>+"),_=new RegExp("^```|^~~~"),R=new RegExp("^[ \\t]+"),v=new RegExp("^\\|.*\\|$"),G=new RegExp("(?<!\\\\(\\\\\\\\)*)\\[.+?\\]: "),I=new RegExp("^(?<!\\\\(\\\\\\\\)*)(\\*[ \\t]*|-[ \\t]*|_[ \\t]*){3,}$");return n(u).then(e=>r(e)).then(e=>a(e)).then(e=>c(e)).then(e=>i(e)).then(e=>s(e))}