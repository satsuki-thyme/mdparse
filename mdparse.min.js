function mdparse(e,t){function n(){let e=[],t=0;return new Promise(n=>{function r(){if(e[t]={},e[t].indentVal=(s[t].match(/^[ \t]*/)||[])[0].length,!d&&h.test(s[t])&&(e[t].class="blank",t<p?(t++,r()):n(e)),!d&&$.test(s[t])&&(e[t].class="h",t<p?(t++,r()):n(e)),d||h.test(s[t])||$.test(s[t])||g.test(s[t])||S.test(s[t])||N.test(s[t])||w.test(s[t])||x.test(s[t])||L.test(s[t])||y.test(s[t])||(e[t].class="p",t<p?(t++,r()):n(e)),d||o||!m.test(s[t])||(e[t].class="li",f.test(s[t])&&(e[t].parent="ul"),q.test(s[t])&&(e[t].parent="ol"),k.test(s[t])&&(e[t].task=!0),o=!0,t<p?(t++,r()):n(e)),!d&&o&&f.test(s[t])&&(e[t].class="li",e[t].parent="ul",g.test(s[t+1])||(o=!1),k.test(s[t])&&(e[t].task=!0),t<p?(t++,r()):n(e)),!d&&o&&q.test(s[t])&&(e[t].class="li",e[t].parent="ol",g.test(s[t+1])||(o=!1),t<p?(t++,r()):n(e)),!d&&S.test(s[t])&&(e[t].class="bq",e[t].bqStack=s[t].match(/^>+/)[0].length,t<p?(t++,r()):n(e)),N.test(s[t])&&(e[t].class="preEnc",d?(e[t].site="end",d=!1,e[t].preGrp=e[t-1].preGrp):(e[t].site="begin",d=!0,e[t].preGrp=t,e[t].lang=s[t].replace(/(```|~~~)[ \t]*/,"")),t<p?(t++,r()):n(e)),d&&!N.test(s[t])&&(e[t].class="preEnc",e[t].site="middle",e[t].preGrp=e[t-1].preGrp,t<p?(t++,r()):n(e)),d||o||!w.test(s[t])||(e[t].class="preInd","preInd"===e[t-1].class&&w.test(s[t+1])&&(e[t].site="middle"),"preInd"!==e[t-1].class&&w.test(s[t+1])&&(e[t].site="begin"),"preInd"!==e[t-1].class||w.test(s[t+1])||(e[t].site="end"),"preInd"===e[t-1].class||w.test(s[t+1])||(e[t].site="az"),t<p?(t++,r()):n(e)),!d&&x.test(s[t])){function a(){"current"===e[t-1].hLine||"after"===e[t-1].hLine?e[t].hLine="after":e[t].hLine="unrelated"}if(e[t].class="table","table"===e[t-1].class&&x.test(s[t+1])&&(e[t].site="middle",e[t].tGrp=e[t-1].tGrp,a()),"table"!==e[t-1].class&&x.test(s[t+1])&&(e[t].site="begin",e[t].tGrp=t,a()),"table"!==e[t-1].class||x.test(s[t+1])||(e[t].site="end",e[t].tGrp=e[t-1].tGrp,a()),"table"===e[t-1].class||x.test(s[t+1])||(e[t].site="az",e[t].tGrp=t,a()),"current"===e[t-1].hLine&&e[t-1].beginWithHLine&&(e[t].beginWithHLine=!0),/^\|([ :]?-+[ :]?\|)+/.test(s[t])){function c(n,r){r--,e[r].tGrp===n&&(e[r].hLine="before",c(n,r)),e[r].tGrp!==n&&r===t-1&&(e[t].beginWithHLine=!0)}e[t].hLine="current",c(e[t].tGrp,t)}t<p?(t++,r()):n(e)}!d&&L.test(s[t])&&(e[t].class="footnote",t<p?(t++,r()):n(e)),!d&&y.test(s[t])&&(e[t].class="hr",t<p?(t++,r()):n(e))}r()})}function r(e){let t=[],n=[];for(let r in e)"preEnc"!==e[r].class&&"preInd"!==e[r].class&&(t.push((s[r].match(/^ +/)||[""])[0].length),n.push((s[r].match(/^\t+/)||[""])[0].length));t=Array.from(new Set(t)).sort((e,t)=>e-t),n=Array.from(new Set(n)).sort((e,t)=>e-t);let r=t.reduce((e,t)=>(e[0].push(t-e[1]),e[1]=t,e),[[],0]).shift(),a=n.reduce((e,t)=>(e[0].push(t-e[1]),e[1]=t,e),[[],0]).shift(),c=(e,t,n)=>(e[t]?e[t].add(n):e[t]=new Set(n),t),i=Math.min([...r.reduce(function(e,t){return t=String(t),this.set(t,c(e,this.get(t)+1||1,t)),e}.bind(new Map),[]).pop()].map(e=>Number(e))),l=Math.min([...a.reduce(function(e,t){return t=String(t),this.set(t,c(e,this.get(t)+1||1,t)),e}.bind(new Map),[]).pop()].map(e=>Number(e)));for(let t in e){let n=(s[t].match(/^[ \t]*/)||[""])[0];e[t].indentNum=Math.floor(0!==i?(n.match(/ /g)||[]).length/i:0)+Math.floor(0!==l?(n.match(/\t/g)||[]).length/l:0)}return e}function a(e){let t=/^\/?(html|head|title|base|link|style|meta|body|article|section|nav|aside|h1|h2|h3|h4|h5|h6|header|footer|address|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|figure|figcaption|main|div|a|em|strong|small|s|cite|q|dfn|abbr|code|var|samp|kbd|data|sub|sup|time|i|b|u|mark|ruby|rb|rt|rtc|rp|bdi|bdo|span|br|wbr|ins|del|img|picture|iframe|embed|object|param|video|audio|track|source|map|area|table|caption|colgroup|col|tbody|thead|tfoot|tr|td|th|form|fieldset|legend|label|input|select|option|optgroup|textarea|button|datalist|output|progress|meter|script|noscript|template|canvas|details|summary|menu|menuitem)$/;for(let n in e)"preEnc"===e[n].class||"preInd"===e[n].class?s[n]=s[n].replace(/<.+?>/g,e=>t.test(e.match(/(?<=<).+?(?=>)/)[0])?e:e.replace(/<(\/?.*)>/g,"&lt;$1&gt;")):s[n]=s[n].replace(/(?<!\\(?:\\\\)*)\\<(.*?)>/g,"&lt;$1&gt;").replace(/(?<!\\(?:\\\\)*)\\</g,"&lt;").replace(/(?<!\\(?:\\\\)*)\\>/g,"&gt;").replace(/(?<!\\(?:\\\\)*)\\(.)/g,"$1").replace(/\\\\/g,"\\");return e}function c(e){function n(e,t){function n(e,t){let n=0;if(t<p){("li"!==e[t+1].class||e[t].parent!==e[t+1].parent&&0===e[t].indentNum&&0===e[t+1].indentNum)&&(n=1);let r=e[t].indentNum-e[t+1].indentNum+n,a=c.slice(-r);return c.splice(-1,r),(a instanceof Array||"array"==typeof a)&&(a=a.reverse().join("></")),`</${a}>`}{n=1;let r=c.pop(e[t].indentNum+ +n);return(r instanceof Array||"array"==typeof r)&&(r=r.reverse().join("></")),`</${r}>`}}function r(e,t){let n=new RegExp("^[ \\t]*[*+\\-] \\[ ?\\]"),r=new RegExp("^[ \\t]*[*+\\-] \\[[xX]\\]");return e[t].task?n.test(s[t])?'<li><input type="checkbox">':r.test(s[t])?'<li><input type="checkbox" checked>':void 0:"<li>"}if(t>0&&t<p){if((e[t].parent===e[t-1].parent||e[t].indentNum<e[t-1].indentNum)&&e[t].indentNum<=e[t-1].indentNum&&(e[t].parent===e[t+1].parent||e[t].indentNum<e[t+1].indentNum)&&e[t].indentNum<=e[t+1].indentNum)return`${r(e,t)}${s[t].replace(g,"")}</li>`;if((e[t].parent!==e[t-1].parent&&e[t].indentNum===e[t-1].indentNum||e[t].indentNum>e[t-1].indentNum)&&(e[t].parent===e[t+1].parent||e[t].indentNum<e[t+1].indentNum)&&e[t].indentNum<=e[t+1].indentNum)return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>`;if((e[t].parent===e[t-1].parent||e[t].indentNum<e[t-1].indentNum)&&e[t].indentNum<=e[t-1].indentNum&&(e[t].parent!==e[t+1].parent&&e[t].indentNum===e[t+1].indentNum||e[t].indentNum>e[t+1].indentNum))return`${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`;if((e[t].parent!==e[t-1].parent&&e[t].indentNum===e[t-1].indentNum||e[t].indentNum>e[t-1].indentNum)&&(e[t].parent!==e[t+1].parent&&e[t].indentNum===e[t+1].indentNum||e[t].indentNum>e[t+1].indentNum))return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`}if(0===t&&t<p){if(e[t].parent===e[t+1].parent&&e[t].indentNum<=e[t+1].indentNum)return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>`;if(e[t].parent!==e[t+1].parent||e[t].indentNum>e[t+1].indentNum)return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`}if(t>0&&t===p){if(e[t].parent===e[t-1].parent&&e[t].indentNum<=e[t-1].indentNum)return`${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`;if(e[t].parent!==e[t-1].parent||e[t].indentNum>e[t-1].indentNum)return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`}if(0===p)return c=c.concat([e[t].parent]),`<${e[t].parent}>${r(e,t)}${s[t].replace(g,"")}</li>${n(e,t)}`}function r(e,t){if(t>0&&t<p){if(e[t].bqStack<=e[t-1].bqStack&&e[t].bqStack<=e[t+1].bqStack)return`<br>${s[t].replace(/^>+ /,"")}`;if(e[t].bqStack>(e[t-1].bqStack||0)&&e[t].bqStack<=e[t+1].bqStack)return`${"<blockquote>".repeat(e[t].bqStack-(e[t-1].bqStack||0))}${s[t].replace(/^>+ /,"")}`;if(e[t].bqStack<=e[t-1].bqStack&&e[t].bqStack>(e[t+1].bqStack||0))return`${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack-(e[t+1].bqStack||0))}`;if(e[t].bqStack>(e[t-1].bqStack||0)&&e[t].bqStack>(e[t+1].bqStack||0))return`${"<blockquote>".repeat(e[t].bqStack-(e[t-1].bqStack||0))}${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack-(e[t+1].bqStack||0))}`}if(0===t&&t<p){if(e[t].bqStack<=e[t+1].bqStack)return`${"<blockquote>".repeat(e[t].bqStack)}${s[t].replace(/^>+ /,"")}`;if(e[t].bqStack>(e[t+1].bqStack||0))return`${"<blockquote>".repeat(e[t].bqStack)}${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack-(e[t+1].bqStack||0))}`}if(t>0&&t===p){if(e[t].bqStack<=e[t-1].bqStack)return`${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack)}`;if(e[t].bqStack>(e[t-1].bqStack||0))return`${"<blockquote>".repeat(e[t].bqStack-(e[t-1].bqStack||0))}${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack)}`}if(0===p)return`${"<blockquote>".repeat(e[t].bqStack)}${s[t].replace(/^>+ /,"")}${"</blockquote>".repeat(e[t].bqStack)}`}let a=0,c=[],i=[],l=[];return d&&(s=s.concat(["```"]),e=e.concat([{class:"preEnc",site:"end"}])),[new Promise(c=>{function o(){switch(e[a].class){case"blank":a<p?(a++,o()):c(e);break;case"h":let d=s[a].match(/^#+/)[0].length;s[a]=`<h${d}>${s[a].replace(/^#+/,"")}</h${d}>`,a<p?(a++,o()):c(e);break;case"p":a===p||"p"!==e[a+1].class||"permissive"===t?(s[a]=`<p>${s[a]}</p>`,a<p?(a++,o()):c(e)):(s[a+1]=`${s[a]}${/<br>$/.test(s[a])?"":" "}${s[a+1]}`,s=s.slice(0,a).concat(s.slice(a+1)),e=e.slice(0,a).concat(e.slice(a+1)),p--,a<p?o():c(e));break;case"li":s[a]=n(e,a),a<p?(a++,o()):c(e);break;case"bq":s[a]=r(e,a),a<p?(a++,o()):c(e);break;case"preEnc":"middle"===e[a].site&&"end"!==e[a+1].site&&(s[a]=`${s[a]}`,a<p?(a++,o()):c(e)),"begin"===e[a].site&&"end"!==e[a+1].site&&(s=s.slice(0,a).concat(s.slice(a+1)),e=e.slice(0,a).concat(e.slice(a+1)),p--,s[a]=""!==e[a].lang?`<pre><code class="language-${e[a].lang}">${s[a]}`:`<pre><code>${s[a]}`,a<p?o():c(e)),"begin"!==e[a].site&&"end"===e[a+1].site&&(s=s.slice(0,a+1).concat(s.slice(a+2)),e=e.slice(0,a+1).concat(e.slice(a+2)),p--,s[a]=`${s[a]}</code></pre>`,a<p?o():c(e)),"begin"===e[a].site&&"end"===e[a+1].site&&(s=s.slice(0,a).concat(s.slice(a+2)),e=e.slice(0,a).concat(e.slice(a+2)),p--,p--,s[a]=""!==e[a].lang?`<pre><code class="language-${e[a].lang}"><br></code></pre>`:"<pre><code><br></code></pre>",a<p?o():c(e));break;case"preInd":"middle"===e[a].site&&(s[a]=`${s[a].replace(u,"")}`),"begin"===e[a].site&&(s[a]=`<pre><code>${s[a].replace(u,"")}`),"end"===e[a].site&&(s[a]=`${s[a].replace(u,"")}</code></pre>`),"az"===e[a].site&&(s[a]=`<pre><code>${s[a].replace(u,"")}</code></pre>`),a<p?(a++,o()):c(e);break;case"table":if("current"!==e[a].hLine){let t="",n="",r="",i="";"middle"===e[a].site&&"current"!==e[a].hLine&&("before"===e[a].hLine&&(r="<th>",i="</th>"),"after"!==e[a].hLine&&"unrelated"!==e[a].hLine||(r="<td>",i="</td>"),e[a].beginWithHLine&&(t="<table><tbody>",r="<td>",i="</td>"),"before"===e[a].hLine&&"current"===e[a+1].hLine&&"end"===e[a+1].site&&(n="</tbody></table>",r="<th>",i="</th>")),"begin"===e[a].site&&("before"===e[a].hLine&&"current"!==e[a+1].hLine&&(t="<table><thead>",r="<th>",i="</th>"),"before"===e[a].hLine&&"current"===e[a+1].hLine&&(t="<table><thead>",n="</thead>",r="<th>",i="</th>"),"unrelated"===e[a].hLine&&(t="<table><tbody>",r="<td>",i="</td>"),"before"===e[a].hLine&&"current"===e[a+1].hLine&&"end"===e[a+1].site&&(t="<table><thead>",n="</thead></table>",r="<td>",i="</td>")),"end"===e[a].site&&("after"===e[a].hLine&&"after"===e[a-1].hLine&&(n="</tbody></table>",r="<td>",i="</td>"),"after"===e[a].hLine&&"before"===e[a-1].hLine&&(t="<tbody>",n="</tbody></table>",r="<td>",i="</td>"),e[a].beginWithHLine&&(t="<table><tbody>",n="</tbody></table>",r="<td>",i="</td>"),"unrelated"===e[a].hLine&&(n="</tbody></table>",r="<td>",i="</td>")),"az"===e[a].site&&(t="<table><tbody>",n="</tbody></table>",r="<td>",i="</td>"),s[a]=s[a].replace(/^\|/,"").replace(/[ \t]*(.*?)[ \t]*(?<!\\(\\\\)*)(?<!\\)\|/g,`${r}$1${i}`).replace(/^/,`${t}<tr>`).replace(/$/,`</tr>${n}`),a<p?(a++,o()):c(e)}else s=s.slice(0,a).concat(s.slice(a+1)),e=e.slice(0,a).concat(e.slice(a+1)),p--,a<p?o():c(e);break;case"footnote":i=i.concat([(s[a].match(/(?<=\[\^).+(?=\]:)/)||[])[0]]),l=l.concat([s[a].replace(/^\[\^.+?\]: ?/,"")]),s=s.slice(0,a).concat(s.slice(a+1)),e=e.slice(0,a).concat(e.slice(a+1)),p--,a<p?o():c(e);break;case"hr":s[a]="<hr>",a<p?(a++,o()):c(e);break;case"unmatched":a<p?(a++,o()):c(e);break;default:console.log(`unexpected error occured at line ${a}\n${s[a]}`),a<p?(a++,o()):c(e)}}o()}),i,l]}function i(e){s=s.filter(e=>0!==e.length);let t=[],n=0,r={},a=1,c={},i=/(?<!\\(?:\\\\)*|!)(?<=\[\^).+?(?=\](?!:))/g;for(let e in s)if(s[e]=s[e].replace(/(\\*)__(.+?)(?<!\\(?:\\\\)*)__/g,(e,t,n)=>t&&t.length%2!=0?e:`<strong>${n}</strong>`).replace(/(\\*)_(.+?)(?<!\\(?:\\\\)*)_/g,(e,t,n)=>t&&t.length%2!=0?e:`<em>${n}</em>`).replace(/(\\*)\*\*(.+?)(?<!\\(?:\\\\)*)\*\*/g,(e,t,n)=>t&&t.length%2!=0?e:`<strong>${n}</strong>`).replace(/(\\*)\*(.+?)(?<!\\(?:\\\\)*)\*/g,(e,t,n)=>t&&t.length%2!=0?e:`<em>${n}</em>`).replace(/(\\*)~~(.+?)(?<!\\(?:\\\\)*)~~/g,(e,t,n)=>t&&t.length%2!=0?e:`<del>${n}</del>`).replace(/(\\*)!\[(.+?)(?<!\\(?:\\\\)*)\]\((.+?)\)/g,(e,t,n,r)=>t&&t.length%2!=0?e:`<img src="${r}" alt="${n}">`).replace(/(\\*)(?<!!)\[(.+?)(?<!\\(?:\\\\)*)\]\((.+?)\)/g,(e,t,n,r)=>t&&t.length%2!=0?e:`<a href="${r}">${n}</a>`),i.test(s[e])){let l=s[e].match(i);for(let i in l){t=t.concat([l[i]]),c[l[i]]?c[l[i]]=c[l[i]].concat([n]):c[l[i]]=[n],Object.keys(r).indexOf(t[n])<0&&(r[t[n]]=a,a++);let p=new RegExp(`(?<!\\\\(?:\\\\\\\\)*|!)\\[\\^${t[n]}\\](?!:)`);s[e]=s[e].replace(p,`<sup>[<a href="#user-content-${t[n]}" name="user-content-return-${n}">${r[t[n]]}</a>]</sup>`),n++}}return[t,c,r,e[1],e[2]]}function l(e){let t=Array.from(new Set(e[0])),n=e[1],r=e[2],a=e[3],c=e[4],i="<sectioin><ul>",l=a.slice(),p=[],o=c.slice(),d=[];for(let e in t)for(let n in a)t[e]===a[n]&&(p=p.concat([a[n]]),l.splice(l.indexOf(a[n]),1),d=d.concat([c[n]]),o.splice(o.indexOf(c[n]),1));for(let e in p)for(let a in t){let c="";if(p[e]===t[a]){for(let e in n[t[a]])c+=`<a href="#user-content-return-${n[t[a]][e]}">${b}</a> `;i+=`<li><a name="user-content-${t[a]}">${r[t[a]]}</a>. ${d[e]} ${c}</li>`}}for(let e in l)i+=`<li>${o[e]}</li>`;return i+="<ul></section>",s.join("\n").replace(/\\+/g,e=>"\\".repeat(Math.floor(e.length/2)))+i}let s=e.replace(/\\/g,"\\\\").replace(/  \r?\n>+ |  (\r?\n|$)/g,"<br>").split(/\r?\n/),p=s.length-1,o=!1,d=!1,u=null,b='<svg class="user-cnt-arrow" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0, 0, 16, 21"><path d="M 0,0 V 2 h 8 c 3,0 6,3 6,6 0,3 -3,6 -6,6 H 7 v 2 h 1 c 4,0 8,-4 8,-8 0,-4 -4,-8 -8,-8 z"/><path d="M 6,21 7,19 3,15 7,11 6,9 0,15 Z"/></svg>',h=new RegExp("^[ \\t]*$"),$=new RegExp("^#{1,6} "),m=new RegExp("^([*+\\-] |\\d+\\. )(?!.*([*\\-_][ \\t]*){2,}).*$"),g=new RegExp("^[ \\t]*([*+\\-] |\\d+\\. )(\\[[ xX]\\])?"),f=new RegExp("^[ \\t]*[*+\\-] "),k=new RegExp("^[ \\t]*[*+\\-] \\[[ xX]\\]"),q=new RegExp("^[ \\t]*\\d+\\. "),S=new RegExp("^>+"),N=new RegExp("^```|^~~~"),w=new RegExp("^[ \\t]+"),x=new RegExp("^\\|.*\\|$"),L=new RegExp("(?<!\\\\(\\\\\\\\)*)\\[.+?\\]: "),y=new RegExp("^(?<!\\\\(\\\\\\\\)*)(\\*[ \\t]*|-[ \\t]*|_[ \\t]*){3,}$");return n(s).then(e=>r(e)).then(e=>a(e)).then(e=>c(e)).then(e=>i(e)).then(e=>l(e))}